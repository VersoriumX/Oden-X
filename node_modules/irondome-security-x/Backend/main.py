from flask import Flask, jsonify, request
from flask_cors import CORS

app = Flask(__name__)
CORS(app)  # Enable CORS for all routes

# Sample data for threats
threats = [
    {"id": 1, "description": "Phishing email detected", "dateDetected": "2023-10-01", "resolved": False},
    {"id": 2, "description": "Malware attachment found", "dateDetected": "2023-10-02", "resolved": False},
    {"id": 3, "description": "Suspicious login attempt", "dateDetected": "2023-10-03", "resolved": True},
]

@app.route('/api/threats', methods=['GET'])
def get_threats():
    """Get the list of threats."""
    return jsonify(threats)

@app.route('/api/threats/<int:threat_id>/resolve', methods=['PUT'])
def resolve_threat(threat_id):
    """Mark a threat as resolved."""
    threat = next((t for t in threats if t['id'] == threat_id), None)
    if threat:
        threat['resolved'] = True
        return jsonify({"message": f"Threat ID {threat_id} marked as resolved."}), 200
    return jsonify({"error": "Threat not found."}), 404

@app.route('/api/threats', methods=['POST'])
def add_threat():
    """Add a new threat."""
    new_threat = request.json
    new_threat['id'] = len(threats) + 1
    new_threat['resolved'] = False
    threats.append(new_threat)
    return jsonify(new_threat), 201

if __name__ == '__main__':
    app.run(debug=True, port=5000)  # Run the app on port 5000
